<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NHL Trade Alert</title>
  <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fff;
      color: #000;
      padding: 20px;
    }
    #tweetForm {
      display: none;
      margin-top: 20px;
    }
    .tweet {
      margin-bottom: 30px;
    }
    input, textarea, button {
      display: block;
      margin: 10px 0;
      padding: 8px;
      width: 100%;
      max-width: 500px;
    }
  </style>
</head>
<body>
  <h1>NHL Trade Alert</h1>

  <!-- Password Field -->
  <div id="passwordAccess">
    <input type="password" id="passwordInput" placeholder="Password" />
    <button onclick="checkPassword()">Unlock</button>
  </div>

  <!-- Hidden Form -->
  <div id="tweetForm">
    <h2>Add a Tweet</h2>
    <form id="generateForm">
      <label for="embed">Paste Twitter Embed Code:</label>
      <textarea id="embed" name="embed" rows="4" required></textarea>
      <button type="submit">Generate JSON Code</button>
    </form>
    <p><strong>Copy this and paste it into your <code>tweets.json</code> file:</strong></p>
    <pre id="output"></pre>
  </div>

  <!-- Tweets Section -->
  <div id="tweetsContainer"></div>

  <script>
    const correctPassword = "nhltradealert2025";

    function checkPassword() {
      const input = document.getElementById("passwordInput").value;
      if (input === correctPassword) {
        document.getElementById("tweetForm").style.display = "block";
        document.getElementById("passwordAccess").style.display = "none";
      } else {
        alert("Incorrect password");
      }
    }

    // Form Submit Handler
    document.getElementById("generateForm").addEventListener("submit", function (event) {
      event.preventDefault();
      const embedCode = document.getElementById("embed").value.trim();
      const jsonOutput = {
        embed: embedCode
      };
      document.getElementById("output").textContent = JSON.stringify(jsonOutput, null, 2) + ",";
    });

    // Load tweets from JSON
    fetch("tweets.json")
      .then((response) => response.json())
      .then((tweets) => {
        const container = document.getElementById("tweetsContainer");
        tweets.forEach((tweet) => {
          const div = document.createElement("div");
          div.className = "tweet";
          div.innerHTML = tweet.embed;
          container.appendChild(div);
        });
        if (window.twttr && window.twttr.widgets) {
          window.twttr.widgets.load();
        }
      })
      .catch((error) => {
        console.error("Error loading tweets:", error);
        document.getElementById("tweetsContainer").innerText = "Error loading tweets. Make sure tweets.json is uploaded and contains valid JSON.";
      });
  </script>
</body>
</html>
